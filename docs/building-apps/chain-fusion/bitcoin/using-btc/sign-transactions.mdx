---
keywords: [advanced, bitcoin, btc, tutorial, sign transactions]
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import { MarkdownChipRow } from "/src/components/Chip/MarkdownChipRow";

# Signing transactions

<MarkdownChipRow labels={["Advanced", "Bitcoin", "Tutorial"]} />

Before a transaction can be sent to the Bitcoin network, each input must be signed.

## Threshold ECDSA

Canisters can sign transactions with threshold ECDSA through the
`sign_with_ecdsa` method.

:::info

To test canisters locally that use the following code snippets, you will need to enable local Bitcoin development. To do this, you can either start the local development environment with `dfx start --enable-bitcoin` or you can include the following configuration in the project's `dfx.json` file:

```json reference
https://github.com/dfinity/examples/blob/master/motoko/basic_bitcoin/dfx.json#L9-L16
```

[Learn more about `dfx.json` configuration options](https://internetcomputer.org/docs/building-apps/developer-tools/dfx-json-reference).

:::

The following snippet shows a simplified example of how to sign a Bitcoin transaction for the special case where all the inputs are referencing outpoints that are owned by `own_address` and `own_address` is a `P2PKH` address.

<Tabs groupId="languages">
<TabItem value="motoko" label="Motoko" default>

```motoko no-repl reference
https://github.com/dfinity/examples/blob/c4cbbfc72c4262c7aad34268ac48e85f3851b40b/motoko/basic_bitcoin/src/basic_bitcoin/src/BitcoinWallet.mo#L161-L212
```

</TabItem>
<TabItem value="rust" label="Rust">

```rust reference
https://github.com/dfinity/examples/blob/c06f27d669ed64e3394ad0c4e484157d1b48209d/rust/basic_bitcoin/src/p2pkh.rs#L58-L117
```

</TabItem>
</Tabs>

## Threshold Schnorr

Canisters can sign transactions with threshold Schnorr through the
`sign_with_schnorr` method.

### Signing P2TR key path transactions

The following snippet shows a simplified example of how to sign a Bitcoin
transaction for the special case where all the inputs are referencing outpoints
that are owned by `own_address` and `own_address` is a `P2TR` address.

<Tabs groupId="languages">
<TabItem value="rust" label="Rust" default>

```rust reference
https://github.com/dfinity/examples/blob/2e748ec113f3c829c076fd3733264aa0ab9e5b6b/motoko/basic_bitcoin/src/basic_bitcoin/src/P2tr.mo#L152-L185
```

</TabItem>
</Tabs>

### Signing P2TR script path transactions

The following snippet shows a simplified example of how to sign a Bitcoin
transaction for the special case where all the inputs are referencing outpoints
that are owned by `own_address` and `own_address` is a `P2TR` script path
address.

<Tabs groupId="languages">
<TabItem value="rust" label="Rust" default>

```rust reference
https://github.com/dfinity/examples/blob/c06f27d669ed64e3394ad0c4e484157d1b48209d/rust/basic_bitcoin/src/p2tr.rs#L116-L185
```

</TabItem>
</Tabs>

## Learn more

[Learn more about threshold ECDSA](/docs/building-apps/network-features/signatures/t-ecdsa).

[Learn more about threshold Schnorr](/docs/building-apps/network-features/signatures/t-schnorr).
