---
keywords: [intermediate, concept, AI, ai, deAI, deai]
---

import TabItem from "@theme/TabItem";
import useBaseUrl from "@docusaurus/useBaseUrl";
import { MarkdownChipRow } from "/src/components/Chip/MarkdownChipRow";

# Decentralized AI samples

<MarkdownChipRow labels={["Intermediate", "Concept", "DeAI" ]} />



ICP's unique ability to run compute at scale allows AI and neural networks to run directly onchain within a canister smart contract. Canisters can also interact with LLMs stored off-chain through HTTPS outcalls, or stored locally on a user's device.

## Image classification

To showcase this capability, this demo example displays how an AI that identifies an image can be deployed as a smart contract with a frontend and backend, both running onchain.

<div class="text--center">
<p> </p>
</div>
<div class="text--center">
<iframe width="660" height="415" src="https://www.youtube.com/embed/6qLvIXiCGcM?si=Jf_m5JfszeNvouL9" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe> </div>

You can find the source code for this demo [on GitHub](https://github.com/dfinity/examples/tree/master/rust/image-classification).

### How this example works

In this example, the ICP smart contract accepts an image as input from the user and runs an image classification inference. The smart contract has two canisters:

- The frontend canister that contains HTML, JS, and CSS assets that are served in the web browser.

- The backend canister that embeds the [Tract ONNX inference engine](https://github.com/sonos/tract) with the [MobileNet v2-7 model](https://github.com/onnx/models/tree/main/validated/vision/classification/mobilenet). This canister provides a `classify()` endpoint that the frontend canister calls.

<div class="text-center">
  <img
    src={useBaseUrl("/img/docs/ai-how-it-works.png")}
    alt="AI Demo: how it works"
    width="800"
  />
</div>

### ICP features that make it possible

To make running AI in a canister possible, two key ICP features are utilized:

1. **WebAssembly virtual machine**: Canister code is compiled into Wasm modules to be deployed on ICP. The WebAssembly virtual machine supports standards such as the WebAssembly System Interface, which can be supported through a community tool called [wasi2ic](https://github.com/wasm-forge/wasi2ic).

<div class="text-center">
  <img
    src={useBaseUrl("/img/docs/ai-wasm.png")}
    alt="AI Demo: Wasm"
    width="800"
  />
</div>

2. **Deterministic time slicing (DTS)**: DTS splits the execution of very large messages that require billions of Wasm instructions across multiple execution rounds.

<div class="text-center">
  <img
    src={useBaseUrl("/img/docs/ai-dts.png")}
    alt="AI Demo: DTS"
    width="800"
  />
</div>

## MNIST

One common machine learning model that is used to train data sets is the Modified National Institute of Standards and Technology (MNIST) database which contains a collection of handwritten numbers. This database is commonly used for training different image processing systems and testing different machine learning platforms.

The [Rust Burn crate](https://docs.rs/burn/latest/burn/) is a deep learning framework package that can be used for creating machine learning programs. This sample will use the MNIST database and the Rust Burn crate to create a simple app where the user will draw a number, and the machine learning model will calculate the probability that the number drawn is a digit between 0-9.

For example, if the user draws the digit `5`, the machine learning model will source the MNIST database, and determine the visual patterns present in both the user's drawn number and the number `5` and calculate the probability that the user drew the number `5`.

View or clone the [GitHub repo for this sample](https://github.com/smallstepman/ic-mnist.git).

This project is based off of one [found within the Rust Burn examples](https://github.com/tracel-ai/burn/tree/main/examples/mnist-inference-web).

## Vector database samples

- [Vectune](https://github.com/ClankPan/Vectune): Vectune is a lightweight VectorDB with incremental indexing, based on FreshVamana written in Rust.
  See [a forum post](https://forum.dfinity.org/t/worlds-largest-web3-vector-database/33309) that explains how it works.
- [ArcMind Vector DB](https://github.com/arcmindai/arcmindvector): A vector database that supports text, image, and audio embedding.
- [KinicDAO Vector DB](https://xcvai-qiaaa-aaaak-afowq-cai.icp0.io/): A high-performance, completely onchain, tamper-proof vector database specifically built for decentralized apps.
- [Blueband](https://github.com/highfeast/ic-use-blueband-db): A vector database built based on [Vectra](https://www.vectra.ai/), a local vector database for [Node.js](https://nodejs.org/en).
  See their [forum post](https://forum.dfinity.org/t/blueband-vector-database/33934) for additional details on how it works and demos.
- [ELNA Vector DB](https://github.com/elna-ai/elna-vector-db): An open-source and fully onchain vector database and vector similarity search engine primarily used to power the [ELNA.ai](https://elna.ai/) application.
